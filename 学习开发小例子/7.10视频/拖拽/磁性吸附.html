<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>无标题文档</title>
<style>
 #div1 {width:100px;height:100px;background:red;position:absolute;}
 #div2 {width:600px;height:600px;background:#ccc;position:relative;}
</style>
<script>

 window.onload=function() {
 
  var oDiv=document.getElementById("div1");
  var oDiv2=document.getElementById("div2");
  
  var disX=0
  var disY=0;
  
  if (oDiv.setCapture()){
  
  oDiv.onmousedown=function(ev) {
  
  var oEvent=ev||event;
  
  disX=oEvent.clientX-oDiv.offsetLeft;
  disY=oEvent.clientY-oDiv.offsetTop;
  
   oDiv.onmousemove=function(ev) {
	
   var oEvent=ev||event;   
   
   var l=oEvent.clientX-disX;
   var t=oEvent.clientY-disY;


		if (l<50){
		   l=0;
		  } 
		  
		else if(l>oDiv2.offsetWidth-oDiv.offsetWidth)
		   {
			  l=oDiv2.offsetWidth-oDiv.offsetWidth;
		   } 

	    if (t<0)
		   {
			t=0;
		   }  
		   
		else if (t>oDiv2.offsetHeight-oDiv.offsetHeight)
		   {
			  t=oDiv2.offsetHeight-oDiv.offsetHeight;
		   }   


			 oDiv.style.left=l+'px';
			 oDiv.style.top=t+'px'   
		  
  }
  
}
   
   oDiv.onmouseup=function() {
	
      oDiv.onmousemove=null;
	  oDiv.onmouseup=null;	 
	  oDiv.releaseCapture(); 
   
  }
  
  oDiv.setCaption();
   return false;
 }
 
 else {
  oDiv.onmousedown=function(ev) {
  
  var oEvent=ev||event;
  
  disX=oEvent.clientX-oDiv.offsetLeft;
  disY=oEvent.clientY-oDiv.offsetTop;
  
   oDiv.onmousemove=function(ev) {
	
   var oEvent=ev||event;   
   
   var l=oEvent.clientX-disX;
   var t=oEvent.clientY-disY;


		if (l<50){
		   l=0;
		  } 
		  
		else if(l>oDiv2.offsetWidth-oDiv.offsetWidth)
		   {
			  l=oDiv2.offsetWidth-oDiv.offsetWidth;
		   } 

	    if (t<0)
		   {
			t=0;
		   }  
		   
		else if (t>oDiv2.offsetHeight-oDiv.offsetHeight)
		   {
			  t=oDiv2.offsetHeight-oDiv.offsetHeight;
		   }   


			 oDiv.style.left=l+'px';
			 oDiv.style.top=t+'px'   
		  
     }
  
  }
   
   oDiv.onmouseup=function() {
	
      oDiv.onmousemove=null;
	  oDiv.onmouseup=null;	 
	    } 

   return false;
 
 } 
}
  

</script>
</head>

<body>
<div id="div2">
   <div id="div1">1234</div>
 vvvvvvvvvvvvvv
 </div>
</body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>无标题文档</title>
</head>

<body>
</body>
</html>
